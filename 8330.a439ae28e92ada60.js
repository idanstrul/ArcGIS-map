"use strict";var Xe=Object.defineProperty,Ke=Object.defineProperties,$e=Object.getOwnPropertyDescriptors,Be=Object.getOwnPropertySymbols,qe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,We=(de,ie,p)=>ie in de?Xe(de,ie,{enumerable:!0,configurable:!0,writable:!0,value:p}):de[ie]=p,Oe=(de,ie)=>{for(var p in ie||(ie={}))qe.call(ie,p)&&We(de,p,ie[p]);if(Be)for(var p of Be(ie))ke.call(ie,p)&&We(de,p,ie[p]);return de},De=(de,ie)=>Ke(de,$e(ie));(self.webpackChunkKapow_Maps_Exam=self.webpackChunkKapow_Maps_Exam||[]).push([[8330],{7848:(de,ie,p)=>{p.d(ie,{G6:()=>G,Ie:()=>V,J9:()=>S,RF:()=>$,U1:()=>Q,vY:()=>K,ym:()=>y});var F=p(62208),Y=p(91179);const J=(o,a,u)=>[a,u],se=(o,a,u)=>[a,u,o[2]],O=(o,a,u)=>[a,u,o[2],o[3]];function K(o){return o?{originPosition:"upper-left"===o.originPosition?"upperLeft":"lower-left"===o.originPosition?"lowerLeft":o.originPosition,scale:o.tolerance?[o.tolerance,o.tolerance]:[1,1],translate:(0,F.pC)(o.extent)?[o.extent.xmin,o.extent.ymax]:[0,0]}:null}function A({scale:o,translate:a},u){return Math.round((u-a[0])/o[0])}function M({scale:o,translate:a},u){return Math.round((a[1]-u)/o[1])}function b(o,a,u){const g=[];let I,D,k,w;for(let pe=0;pe<u.length;pe++){const le=u[pe];pe>0?(k=A(o,le[0]),w=M(o,le[1]),k===I&&w===D||(g.push(a(le,k-I,w-D)),I=k,D=w)):(I=A(o,le[0]),D=M(o,le[1]),g.push(a(le,I,D)))}return g.length>0?g:null}function ne({scale:o,translate:a},u){return u*o[0]+a[0]}function ee({scale:o,translate:a},u){return a[1]-u*o[1]}function Ie(o,a,u){const g=new Array(u.length);if(!u.length)return g;const[I,D]=o.scale;let k=ne(o,u[0][0]),w=ee(o,u[0][1]);g[0]=a(u[0],k,w);for(let pe=1;pe<u.length;pe++){const le=u[pe];k+=le[0]*I,w-=le[1]*D,g[pe]=a(le,k,w)}return g}function Ee(o,a,u){const g=new Array(u.length);for(let I=0;I<u.length;I++)g[I]=Ie(o,a,u[I]);return g}function $(o,a,u,g,I){return a.x=A(o,u.x),a.y=M(o,u.y),a!==u&&(g&&(a.z=u.z),I&&(a.m=u.m)),a}function y(o,a){return o&&a?(0,Y.wp)(a)?$(o,{},a,!1,!1):(0,Y.l9)(a)?function Z(o,a,u,g,I){const D=function ce(o,a,u,g){const I=[],D=u?g?O:se:g?se:J;for(let k=0;k<a.length;k++){const w=b(o,D,a[k]);w&&w.length>=2&&I.push(w)}return I.length?I:null}(o,u.paths,g,I);return D?(a.paths=D,a):null}(o,{},a,!1,!1):(0,Y.oU)(a)?function re(o,a,u,g,I){const D=function fe(o,a,u,g){const I=[],D=u?g?O:se:g?se:J;for(let k=0;k<a.length;k++){const w=b(o,D,a[k]);w&&w.length>=3&&I.push(w)}return I.length?I:null}(o,u.rings,g,I);return D?(a.rings=D,a):null}(o,{},a,!1,!1):(0,Y.aW)(a)?function B(o,a,u,g,I){return a.points=function oe(o,a,u,g){return b(o,u?g?O:se:g?se:J,a)}(o,u.points,g,I),a}(o,{},a,!1,!1):(0,Y.YX)(a)?function R(o,a,u,g,I){return a.xmin=A(o,u.xmin),a.ymin=M(o,u.ymin),a.xmax=A(o,u.xmax),a.ymax=M(o,u.ymax),a!==u&&(g&&(a.zmin=u.zmin,a.zmax=u.zmax),I&&(a.mmin=u.mmin,a.mmax=u.mmax)),a}(o,{},a,!1,!1):null:null}function S(o,a,u,g,I){return(0,F.pC)(u)&&(a.points=function Pe(o,a,u,g){return Ie(o,u?g?O:se:g?se:J,a)}(o,u.points,g,I)),a}function Q(o,a,u,g,I){return(0,F.Wi)(u)||(a.x=ne(o,u.x),a.y=ee(o,u.y),a!==u&&(g&&(a.z=u.z),I&&(a.m=u.m))),a}function V(o,a,u,g,I){return(0,F.pC)(u)&&(a.rings=function ye(o,a,u,g){return Ee(o,u?g?O:se:g?se:J,a)}(o,u.rings,g,I)),a}function G(o,a,u,g,I){return(0,F.pC)(u)&&(a.paths=function me(o,a,u,g){return Ee(o,u?g?O:se:g?se:J,a)}(o,u.paths,g,I)),a}},38330:(de,ie,p)=>{p.d(ie,{Z:()=>Le});var F=p(15861),Y=p(26584),ae=p(58817),J=p(62208),se=p(1036),O=p(16730),K=p(5548),H=p(65401),A=p(32442),M=p(91179),b=p(13924),j=p(37053),oe=p(78498),fe=p(10410);const ne=new class ce{constructor(t,i){this._cache=new oe.Z(t),this._invalidCache=new oe.Z(i)}get(t,i){const e=`${i.uid}:${t}`,r=this._cache.get(e);if(r)return r;if(void 0!==this._invalidCache.get(e))return null;try{const s=fe.WhereClause.create(t,i);return this._cache.put(e,s),s}catch(s){return this._invalidCache.put(e,null),null}}}(50,500),ee="feature-store:unsupported-query",Ee=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);function me(N,t){return N?ne.get(N,t):null}function ye(N,t,i,e=!0){const r=[];for(const s of t)if("*"!==s&&!N.has(s))if(e){const l=xe(s);try{const f=me(l,N);if(!f)throw new Y.Z(ee,"invalid SQL expression",{where:l});if(!f.isStandardized)throw new Y.Z(ee,"expression is not standard",{clause:f});ye(N,f.fieldNames,"expression contains missing fields")}catch(f){const m=f&&f.details;if(m&&(m.clause||m.where))throw f;m&&m.missingFields?r.push(...m.missingFields):r.push(s)}}else r.push(s);if(r.length)throw new Y.Z(ee,i,{missingFields:r})}function xe(N){return N.split(" as ")[0]}function Fe(N,t){const i=t.get(N);return!!i&&!Ee.has(i.type)}var he=p(82959),E=p(87757),R=p(27105),B=p(15176),$=p(7848),re=p(82054),Z=p(63930);class y{constructor(t,i,e){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=t.returnDistinctValues,this.fieldsIndex=e,this.featureAdapter=i;const r=t.outFields;if(r&&-1===r.indexOf("*")){this.outFields=r;let s=0;for(const l of r){const f=xe(l),m=this.fieldsIndex.get(f),h=m?null:me(f,e),x=m?m.name:l.split(" as ")[1]||"FIELD_EXP_"+s++;this._fieldDataCache.set(l,{alias:x,clause:h})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach(i=>this.getAttributes(i)),this._returnDistinctMap.size):t.length}getAttributes(t){const i=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(i)}getFieldValue(t,i,e){const r=e?e.name:i;let s=null;return this._fieldDataCache.has(r)?s=this._fieldDataCache.get(r).clause:e||(s=me(i,this.fieldsIndex),this._fieldDataCache.set(r,{alias:r,clause:s})),e?this.featureAdapter.getAttribute(t,r):s.calculateValue(t,this.featureAdapter)}getNormalizedValue(t,i){const e=i.normalizationType,r=i.normalizationTotal;let s=this.getFieldValue(t,i.field,i.fieldInfo);if(e&&Number.isFinite(s)){const l=this.getFieldValue(t,i.normalizationField,i.normalizationFieldInfo);s=(0,Z.fk)(s,e,l,r)}return s}getExpressionValue(t,i,e){const r={attributes:this.featureAdapter.getAttributes(t)},s=e.createExecContext(r,i.viewInfo);return e.executeFunction(i.compiledFunc,s)}validateItem(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:me(i,this.fieldsIndex)}),this._fieldDataCache.get(i).clause.testFeature(t,this.featureAdapter)}validateItems(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:me(i,this.fieldsIndex)}),this._fieldDataCache.get(i).clause.testSet(t,this.featureAdapter)}_processAttributesForOutFields(t){const i=this.outFields;if(!i||!i.length)return this.featureAdapter.getAttributes(t);const e={};for(const r of i){const{alias:s,clause:l}=this._fieldDataCache.get(r);e[s]=l?l.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,s)}return e}_processAttributesForDistinctValues(t){if((0,J.Wi)(t)||!this.returnDistinctValues)return t;const i=this.outFields,e=[];if(i)for(const l of i){const{alias:f}=this._fieldDataCache.get(l);e.push(t[f])}else for(const l in t)e.push(t[l]);const r=`${(i||["*"]).join(",")}=${e.join(",")}`;let s=this._returnDistinctMap.get(r)||0;return this._returnDistinctMap.set(r,++s),s>1?null:t}}var u,N,_=p(76530),S=p(6185),Q=p(36630),V=p(46679);class G{constructor(t,i,e){this.items=t,this.queryGeometry=i,this.definitionExpression=e.definitionExpression,this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.fieldsIndex=e.fieldsIndex,this.timeInfo=e.timeInfo,this.featureAdapter=e.featureAdapter,this.aggregateAdapter=e.aggregateAdapter}get size(){return this.items.length}createQueryResponseForCount(t){const i=new y(t,this.featureAdapter,this.fieldsIndex);if(!t.outStatistics)return i.countDistinctValues(this.items);const{groupByFieldsForStatistics:e,having:r}=t;if(!(null==e?void 0:e.length))return 1;const s=new Map,l=new Map,f=new Set,m=t.outStatistics;for(const h of m){const{statisticType:x}=h,v="exceedslimit"!==x?h.onStatisticField:void 0;if(!l.has(v)){const P=[];for(const C of e){const T=this._getAttributeValues(i,C,s);P.push(T)}l.set(v,this._calculateUniqueValues(P,i.returnDistinctValues))}const z=l.get(v);for(const P in z){const{data:C,items:T}=z[P],X=C.join(",");r&&!i.validateItems(T,r)||f.add(X)}}return f.size}createQueryResponse(t){var i=this;return(0,F.Z)(function*(){let e;return e=t.outStatistics?t.outStatistics.some(r=>"exceedslimit"===r.statisticType)?i._createExceedsLimitQueryResponse(t):yield i._createStatisticsQueryResponse(t):i._createFeatureQueryResponse(t),t.returnQueryGeometry&&(e.queryGeometry=(0,j.JY)(t.outSR)&&!(0,j.fS)(i.queryGeometry.spatialReference,t.outSR)?(0,S.S2)(Oe({spatialReference:t.outSR},(0,he.iV)(i.queryGeometry,i.queryGeometry.spatialReference,t.outSR))):(0,S.S2)(Oe({spatialReference:t.outSR},i.queryGeometry))),e})()}createSnappingResponse(t,i){const e=this.featureAdapter,r=function a(N,t){return N?t?4:3:t?3:2}(this.hasZ,this.hasM),{x:s,y:l}=t.point,f="number"==typeof t.distance?t.distance:t.distance.x,m="number"==typeof t.distance?t.distance:t.distance.y,h={candidates:[]},x="esriGeometryPolygon"===this.geometryType,v=this._getPointCreator(t.point,this.spatialReference,i);for(const z of this.items){const P=e.getGeometry(z);if((0,J.Wi)(P))continue;const{coords:C,lengths:T}=P;if(t.types&u.EDGE){let X=0;for(let q=0;q<T.length;q++){const ue=T[q];for(let W=0;W<ue;W++,X+=r){const te=C[X],L=C[X+1];if(W!==ue-1){const U=C[X+r],ge=C[X+r+1],{x:Se,y:Te}=o(s,l,te,L,U,ge),Me=(s-Se)/f,_e=(l-Te)/m,Ae=Me*Me+_e*_e;Ae<=1&&h.candidates.push({type:"edge",objectId:e.getObjectId(z),distance:Math.sqrt(Ae),target:v(Se,Te),start:v(te,L),end:v(U,ge)})}}}}if(t.types&u.VERTEX){const X=x?C.length-r:C.length;for(let q=0;q<X;q+=r){const ue=C[q],W=C[q+1],te=(s-ue)/f,L=(l-W)/m,U=te*te+L*L;U<=1&&h.candidates.push({type:"vertex",objectId:e.getObjectId(z),distance:Math.sqrt(U),target:v(ue,W)})}}}return h.candidates.sort((z,P)=>z.distance-P.distance),h}_getPointCreator(t,i,e){const r=(0,J.pC)(e)&&!(0,j.fS)(i,e)?s=>(0,he.iV)(s,i,e):s=>s;return null!=t.z&&null!=t.m?(s,l)=>r({x:s,y:l,z:t.z,m:t.m}):null!=t.z?(s,l)=>r({x:s,y:l,z:t.z}):null!=t.m?(s,l)=>r({x:s,y:l,m:t.m}):(s,l)=>r({x:s,y:l})}executeAttributesQuery(t){const i=me(t.where,this.fieldsIndex);if(!i)return Promise.resolve(this);if(i.isStandardized){let e=0;const r=[];for(const l of this.items)i.testFeature(l,this.featureAdapter)&&(r[e++]=l);const s=new G(r,this.queryGeometry,this);return s.definitionExpression=t.where,Promise.resolve(s)}return Promise.reject(new TypeError("Where clause is not standardized"))}executeAggregateIdsQuery(t){if(!t.aggregateIds||!t.aggregateIds.length||(0,J.Wi)(this.aggregateAdapter))return Promise.resolve(this);const i=new Set;for(const r of t.aggregateIds)this.aggregateAdapter.getFeatureObjectIds(r).forEach(s=>i.add(s));const e=this.featureAdapter.getObjectId;return Promise.resolve(new G(this.items.filter(r=>i.has(e(r))),this.queryGeometry,this))}executeObjectIdsQuery(t){if(!t.objectIds||!t.objectIds.length)return Promise.resolve(this);const i=new Set(t.objectIds),e=this.featureAdapter.getObjectId;return Promise.resolve(new G(this.items.filter(r=>i.has(e(r))),this.queryGeometry,this))}executeTimeQuery(t){const i=(0,_.y)(this.timeInfo,t.timeExtent,this.featureAdapter);if(!(0,J.pC)(i))return Promise.resolve(this);const e=this.items.filter(i);return Promise.resolve(new G(e,this.queryGeometry,this))}filterLatest(){const{trackIdField:t,startTimeField:i,endTimeField:e}=this.timeInfo,r=e||i,s=new Map,l=this.featureAdapter.getAttribute;for(const m of this.items){const h=l(m,t),x=l(m,r),v=s.get(h);(!v||x>l(v,r))&&s.set(h,m)}const f=Array.from(s.values());return Promise.resolve(new G(f,this.queryGeometry,this))}project(t){var i=this;return(0,F.Z)(function*(){if(!t||(0,j.fS)(i.spatialReference,t))return i;const e=i.featureAdapter,r=(yield(0,he.oj)(i.items.map(s=>(0,S.Op)(i.geometryType,i.hasZ,i.hasM,e.getGeometry(s))),i.spatialReference,t)).map((s,l)=>e.cloneWithGeometry(i.items[l],(0,re.GH)(s,i.hasZ,i.hasM)));return new G(r,i.queryGeometry,{definitionExpression:i.definitionExpression,geometryType:i.geometryType,hasM:i.hasM,hasZ:i.hasZ,objectIdField:i.objectIdField,spatialReference:t,fieldsIndex:i.fieldsIndex,timeInfo:i.timeInfo,featureAdapter:i.featureAdapter})})()}createSummaryStatisticsResponse(t,i){var e=this;return(0,F.Z)(function*(){const{field:r,valueExpression:s,normalizationField:l,normalizationType:f,normalizationTotal:m,minValue:h,maxValue:x,scale:v}=i,z=e.fieldsIndex.isDateField(r),P=yield e._getDataValues(t,{field:r,valueExpression:s,normalizationField:l,normalizationType:f,normalizationTotal:m,scale:v}),C=(0,Z.S5)({normalizationType:f,normalizationField:l,minValue:h,maxValue:x}),T=e.fieldsIndex.get(r),X={value:.5,fieldType:null==T?void 0:T.type},q=(0,Q.qN)(T)?(0,Z.H0)({values:P,supportsNullCount:C,percentileParams:X}):(0,Z.i5)({values:P,minValue:h,maxValue:x,useSampleStdDev:!f,supportsNullCount:C,percentileParams:X});return(0,Z.F_)(q,z)})()}createUniqueValuesResponse(t,i){var e=this;return(0,F.Z)(function*(){const{field:r,valueExpression:s,domain:l,returnAllCodedValues:f,scale:m}=i,h=yield e._getDataValues(t,{field:r,valueExpression:s,scale:m}),x=(0,Z.eT)(h);return(0,Z.Qm)(x,l,f)})()}createClassBreaksResponse(t,i){var e=this;return(0,F.Z)(function*(){const{field:r,valueExpression:s,normalizationField:l,normalizationType:f,normalizationTotal:m,classificationMethod:h,standardDeviationInterval:x,minValue:v,maxValue:z,numClasses:P,scale:C}=i,T=yield e._getDataValues(t,{field:r,valueExpression:s,normalizationField:l,normalizationType:f,normalizationTotal:m,scale:C}),X=(0,Z.G2)(T,{field:r,normalizationField:l,normalizationType:f,normalizationTotal:m,classificationMethod:h,standardDeviationInterval:x,minValue:v,maxValue:z,numClasses:P});return(0,Z.DL)(X,h)})()}createHistogramResponse(t,i){var e=this;return(0,F.Z)(function*(){const{field:r,valueExpression:s,normalizationField:l,normalizationType:f,normalizationTotal:m,classificationMethod:h,standardDeviationInterval:x,minValue:v,maxValue:z,numBins:P,scale:C}=i,T=yield e._getDataValues(t,{field:r,valueExpression:s,normalizationField:l,normalizationType:f,normalizationTotal:m,scale:C});return(0,Z.oF)(T,{field:r,normalizationField:l,normalizationType:f,normalizationTotal:m,classificationMethod:h,standardDeviationInterval:x,minValue:v,maxValue:z,numBins:P})})()}_sortFeatures(t,i,e){if(t.length>1&&i&&i.length)for(const r of i.reverse()){const s=r.split(" "),l=s[0],f=this.fieldsIndex.get(l),m=s[1]&&"desc"===s[1].toLowerCase(),h=(0,Z.Lq)(null==f?void 0:f.type,m);t.sort((x,v)=>{const z=e(x,l,f),P=e(v,l,f);return h(z,P)})}}_createFeatureQueryResponse(t){const i=this.items,{geometryType:e,hasM:r,hasZ:s,objectIdField:l,spatialReference:f}=this,{outFields:m,outSR:h,quantizationParameters:x,resultRecordCount:v,resultOffset:z,returnZ:P,returnM:C}=t,T=null!=v&&i.length>(z||0)+v,X=m&&(m.includes("*")?[...this.fieldsIndex.fields]:m.map(q=>this.fieldsIndex.get(q)));return{exceededTransferLimit:T,features:this._createFeatures(t,i),fields:X,geometryType:e,hasM:r&&C,hasZ:s&&P,objectIdFieldName:l,spatialReference:(0,S.S2)(h||f),transform:x&&(0,$.vY)(x)||null}}_createFeatures(t,i){const e=new y(t,this.featureAdapter,this.fieldsIndex),{hasM:r,hasZ:s}=this,{orderByFields:l,quantizationParameters:f,returnGeometry:m,returnCentroid:h,maxAllowableOffset:x,resultOffset:v,resultRecordCount:z,returnZ:P=!1,returnM:C=!1}=t,T=s&&P,X=r&&C;let q=[],ue=0;const W=[...i];if(this._sortFeatures(W,l,(L,U,ge)=>e.getFieldValue(L,U,ge)),m||h){const L=(0,$.vY)(f);if(m&&!h)for(const U of W)q[ue++]={attributes:e.getAttributes(U),geometry:(0,S.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(U),x,L,T,X)};else if(!m&&h)for(const U of W)q[ue++]={attributes:e.getAttributes(U),centroid:(0,S.EG)(this,this.featureAdapter.getCentroid(U,this),L)};else for(const U of W)q[ue++]={attributes:e.getAttributes(U),centroid:(0,S.EG)(this,this.featureAdapter.getCentroid(U,this),L),geometry:(0,S.Op)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(U),x,L,T,X)}}else for(const L of W){const U=e.getAttributes(L);U&&(q[ue++]={attributes:U})}const te=v||0;return null!=z&&(q=q.slice(te,Math.min(q.length,te+z))),q}_createExceedsLimitQueryResponse(t){let i=!1,e=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const l of t.outStatistics)if("exceedslimit"===l.statisticType){e=null!=l.maxPointCount?l.maxPointCount:Number.POSITIVE_INFINITY,r=null!=l.maxRecordCount?l.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=l.maxVertexCount?l.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)i=this.items.length>e;else if(this.items.length>r)i=!0;else{const l=this.hasZ?this.hasM?4:3:this.hasM?3:2,f=this.featureAdapter;i=this.items.reduce((m,h)=>{const x=f.getGeometry(h);return m+((0,J.pC)(x)&&x.coords.length||0)},0)/l>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(i)}}]}}_createStatisticsQueryResponse(t){var i=this;return(0,F.Z)(function*(){const e={attributes:{}},r=[],s=new Map,l=new Map,f=new Map,m=new Map,h=new y(t,i.featureAdapter,i.fieldsIndex),x=t.outStatistics,{groupByFieldsForStatistics:v,having:z,orderByFields:P}=t,C=v&&v.length,T=!!C,X=T&&v[0],q=T&&!i.fieldsIndex.get(X);for(const W of x){const{outStatisticFieldName:te,statisticType:L}=W,U=W,ge="exceedslimit"!==L?W.onStatisticField:void 0,Se="percentile_disc"===L||"percentile_cont"===L,Te="EnvelopeAggregate"===L||"CentroidAggregate"===L||"ConvexHullAggregate"===L,Me=T&&1===C&&(ge===X||q)&&"count"===L;if(T){if(!f.has(ge)){const Ae=[];for(const be of v){const Ze=i._getAttributeValues(h,be,s);Ae.push(Ze)}f.set(ge,i._calculateUniqueValues(Ae,h.returnDistinctValues))}const _e=f.get(ge);for(const Ae in _e){const{count:be,data:Ze,items:we,itemPositions:Je}=_e[Ae],Ue=Ze.join(",");if(!z||h.validateItems(we,z)){const Qe=m.get(Ue)||{attributes:{}};if(Te){Qe.aggregateGeometries||(Qe.aggregateGeometries={});const{aggregateGeometries:Ce,outStatisticFieldName:Ge}=yield i._getAggregateGeometry(U,we);Qe.aggregateGeometries[Ge]=Ce}else{let Ce=null;if(Me)Ce=be;else{const Ge=i._getAttributeValues(h,ge,s),je=Je.map(He=>Ge[He]);Ce=Se&&"statisticParameters"in U?i._getPercentileValue(U,je):i._getStatisticValue(U,je,null,h.returnDistinctValues)}Qe.attributes[te]=Ce}v.forEach((Ce,Ge)=>Qe.attributes[i.fieldsIndex.get(Ce)?Ce:`EXPR_${Ge+1}`]=Ze[Ge]),m.set(Ue,Qe)}}}else if(Te){e.aggregateGeometries||(e.aggregateGeometries={});const{aggregateGeometries:_e,outStatisticFieldName:Ae}=yield i._getAggregateGeometry(U,i.items);e.aggregateGeometries[Ae]=_e}else{const _e=i._getAttributeValues(h,ge,s);e.attributes[te]=Se&&"statisticParameters"in U?i._getPercentileValue(U,_e):i._getStatisticValue(U,_e,l,h.returnDistinctValues)}r.push({name:te,alias:te,type:"esriFieldTypeDouble"})}const ue=T?Array.from(m.values()):[e];return i._sortFeatures(ue,P,(W,te)=>W.attributes[te]),{fields:r,features:ue}})()}_getAggregateGeometry(t,i){var e=this;return(0,F.Z)(function*(){const r=yield Promise.all([p.e(4918),p.e(8592)]).then(p.bind(p,32825)),{statisticType:s,outStatisticFieldName:l}=t,{featureAdapter:f,spatialReference:m,geometryType:h,hasZ:x,hasM:v}=e,z=i.map(T=>(0,S.Op)(h,x,v,f.getGeometry(T))),P=r.convexHull(m,z,!0)[0],C={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===s){const T=P?(0,B._w)(P):(0,B.aO)(r.union(m,z));C.aggregateGeometries=De(Oe({},T),{spatialReference:m}),C.outStatisticFieldName=l||"extent"}else if("CentroidAggregate"===s){const T=P?(0,R.tO)(P):(0,R.$G)((0,B.aO)(r.union(m,z)));C.aggregateGeometries={x:T[0],y:T[1],spatialReference:m},C.outStatisticFieldName=l||"centroid"}else"ConvexHullAggregate"===s&&(C.aggregateGeometries=P,C.outStatisticFieldName=l||"convexHull");return C})()}_getStatisticValue(t,i,e,r){const{onStatisticField:s,statisticType:l}=t;let f=null;return f=null!=e&&e.has(s)?e.get(s):(0,Q.qN)(this.fieldsIndex.get(s))?(0,Z.H0)({values:i,returnDistinct:r}):(0,Z.i5)({values:i,minValue:null,maxValue:null,useSampleStdDev:!0}),e&&e.set(s,f),f["var"===l?"variance":l]}_getPercentileValue(t,i){const{onStatisticField:e,statisticParameters:r,statisticType:s}=t,{value:l,orderBy:f}=r,m=this.fieldsIndex.get(e);return(0,Z.XL)(i,{value:l,orderBy:f,fieldType:null==m?void 0:m.type,isDiscrete:"percentile_disc"===s})}_getAttributeValues(t,i,e){if(e.has(i))return e.get(i);const r=this.fieldsIndex.get(i),s=this.items.map(l=>t.getFieldValue(l,i,r));return e.set(i,s),s}_getAttributeNormalizedValues(t,i){return this.items.map(e=>t.getNormalizedValue(e,{field:i.field,fieldInfo:this.fieldsIndex.get(i.field),normalizationField:i.normalizationField,normalizationFieldInfo:this.fieldsIndex.get(i.normalizationField),normalizationType:i.normalizationType,normalizationTotal:i.normalizationTotal}))}_getAttributeExpressionValues(t,i,e){var r=this;return(0,F.Z)(function*(){const{arcadeUtils:s}=yield(0,V.LC)(),l=s.createFunction(i),f=e&&s.getViewInfo(e);return r.items.map(m=>t.getExpressionValue(m,{compiledFunc:l,viewInfo:f},s))})()}_calculateUniqueValues(t,i){const e={},r=this.items,s=r.length;for(let l=0;l<s;l++){const f=r[l],m=[];for(const x of t)m.push(x[l]);const h=m.join(",");i?null==e[h]&&(e[h]={count:1,data:m,items:[f],itemPositions:[l]}):null==e[h]?e[h]={count:1,data:m,items:[f],itemPositions:[l]}:(e[h].count++,e[h].items.push(f),e[h].itemPositions.push(l))}return e}_getDataValues(t,i){var e=this;return(0,F.Z)(function*(){const r=new y(t,e.featureAdapter,e.fieldsIndex),{valueExpression:s,field:l,normalizationField:f,normalizationType:m,normalizationTotal:h,scale:x}=i;return s?e._getAttributeExpressionValues(r,s,s?{viewingMode:"map",scale:x,spatialReference:t.outSR||e.spatialReference}:null):e._getAttributeNormalizedValues(r,{field:l,normalizationField:f,normalizationType:m,normalizationTotal:h})})()}}function o(N,t,i,e,r,s){const l=r-i,f=s-e,x=Math.min(1,Math.max(0,((N-i)*l+(t-e)*f)/(l*l+f*f)));return{x:i+l*x,y:e+f*x}}(N=u||(u={}))[N.NONE=0]="NONE",N[N.EDGE=1]="EDGE",N[N.VERTEX=2]="VERTEX";var g=p(53023),I=p(60466),D=p(74447);const w="feature-store:unsupported-query",le=new Set,Ne=new se.WJ(2e6);let Ve=0;class Le{constructor(t){this.capabilities={query:E.g},this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.definitionExpression=t.definitionExpression,this.featureStore=t.featureStore,this.aggregateAdapter=t.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",()=>this.clearCache()),this.timeInfo=t.timeInfo,t.cacheSpatialQueries&&(this._geometryQueryCache=new se.Xq(Ve+++"$$",Ne)),this.fieldsIndex=new I.Z(t.fields),t.scheduler&&t.priority&&(this._frameTask=t.scheduler.registerTask(t.priority))}destroy(){this._frameTask=(0,J.hw)(this._frameTask),this.clearCache(),(0,J.SC)(this._geometryQueryCache),this._changeHandle=(0,J.hw)(this._changeHandle),(0,J.SC)(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}get fullExtent(){const t=this.featureStore.fullBounds;return t?{xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:(0,S.S2)(this.spatialReference)}:null}get timeExtent(){return this.timeInfo?(this._timeExtent||(this._timeExtent=(0,_.R)(this.timeInfo,this.featureStore)),this._timeExtent):null}clearCache(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null,this._timeExtent=null}executeQuery(t={},i){var e=this;return(0,F.Z)(function*(){let r,s=(0,ae.d9)(t);try{s=yield e._schedule(()=>(0,S.Up)(s,e.definitionExpression,e.spatialReference),i),s=yield e._reschedule(()=>e._checkQuerySupport(s),i),r=yield e._reschedule(()=>e._executeGeometryQuery(s,i),i),r=yield e._reschedule(()=>r.executeAggregateIdsQuery(s),i),r=yield e._reschedule(()=>r.executeObjectIdsQuery(s),i),r=yield e._reschedule(()=>r.executeTimeQuery(s),i),r=yield e._reschedule(()=>r.executeAttributesQuery(s),i)}catch(l){if(l!==S.vF)throw l;r=new G([],null,e)}return r.createQueryResponse(s)})()}executeQueryForCount(t={},i){var e=this;return(0,F.Z)(function*(){let r=(0,ae.d9)(t);r.returnGeometry=!1,r.returnCentroid=!1,r.outSR=null;try{r=yield e._schedule(()=>(0,S.Up)(r,e.definitionExpression,e.spatialReference),i),r=yield e._reschedule(()=>e._checkQuerySupport(r),i);let s=yield e._reschedule(()=>e._executeGeometryQuery(r,i),i);return s=yield e._reschedule(()=>s.executeAggregateIdsQuery(r),i),s=yield e._reschedule(()=>s.executeObjectIdsQuery(r),i),s=yield e._reschedule(()=>s.executeTimeQuery(r),i),s=yield e._reschedule(()=>s.executeAttributesQuery(r),i),s.createQueryResponseForCount(r)}catch(s){if(s!==S.vF)throw s;return 0}})()}executeQueryForExtent(t={},i){var e=this;return(0,F.Z)(function*(){let r,s=(0,ae.d9)(t);const l=s.outSR;try{s=yield e._schedule(()=>(0,S.Up)(s,e.definitionExpression,e.spatialReference),i),s=yield e._reschedule(()=>e._checkQuerySupport(s),i),s.returnGeometry=!0,s.returnCentroid=!1,s.outSR=null,r=yield e._reschedule(()=>e._executeGeometryQuery(s,i),i),r=yield e._reschedule(()=>r.executeAggregateIdsQuery(s),i),r=yield e._reschedule(()=>r.executeObjectIdsQuery(s),i),r=yield e._reschedule(()=>r.executeTimeQuery(s),i),r=yield e._reschedule(()=>r.executeAttributesQuery(s),i);const f=r.size;if(!f)return{count:f,extent:null};(0,K.t8)(Re,K.Gv),e.featureStore.forEachBounds(r.items,x=>(0,K.TC)(Re,x),Ye);const m={xmin:Re[0],ymin:Re[1],xmax:Re[3],ymax:Re[4],spatialReference:(0,S.S2)(e.spatialReference)};e.hasZ&&isFinite(Re[2])&&isFinite(Re[5])&&(m.zmin=Re[2],m.zmax=Re[5]);const h=(0,he.iV)(m,r.spatialReference,l);if(h.spatialReference=(0,S.S2)(l||e.spatialReference),h.xmax-h.xmin==0){const x=(0,O.c9)(h.spatialReference);h.xmin-=x,h.xmax+=x}if(h.ymax-h.ymin==0){const x=(0,O.c9)(h.spatialReference);h.ymin-=x,h.ymax+=x}if(e.hasZ&&null!=h.zmin&&null!=h.zmax&&h.zmax-h.zmin==0){const x=(0,O.c9)(h.spatialReference);h.zmin-=x,h.zmax+=x}return{count:f,extent:h}}catch(f){if(f===S.vF)return{count:0,extent:null};throw f}})()}executeQueryForIds(t={},i){var e=this;return(0,F.Z)(function*(){return e.executeQueryForIdSet(t,i).then(r=>Array.from(r))})()}executeQueryForIdSet(t={},i){var e=this;return(0,F.Z)(function*(){let r,s=(0,ae.d9)(t);s.returnGeometry=!1,s.returnCentroid=!1,s.outSR=null;try{s=yield e._schedule(()=>(0,S.Up)(s,e.definitionExpression,e.spatialReference),i),s=yield e._reschedule(()=>e._checkQuerySupport(s),i),r=yield e._reschedule(()=>e._executeGeometryQuery(s,i),i),r=yield e._reschedule(()=>r.executeAggregateIdsQuery(s),i),r=yield e._reschedule(()=>r.executeObjectIdsQuery(s),i),r=yield e._reschedule(()=>r.executeTimeQuery(s),i),r=yield e._reschedule(()=>r.executeAttributesQuery(s),i);const l=r.items,f=new Set;return yield e._reschedule(()=>{for(const m of l)f.add(r.featureAdapter.getObjectId(m))},i),f}catch(l){if(l===S.vF)return new Set;throw l}})()}executeQueryForSnapping(t,i){var e=this;return(0,F.Z)(function*(){const{point:r,distance:s,types:l}=t;if(l===u.NONE)return{candidates:[]};const f=yield e._reschedule(()=>e._checkQuerySupport(t.query),i),m=!(0,j.fS)(r.spatialReference,e.spatialReference);m&&(yield(0,he._W)(r.spatialReference,e.spatialReference));const h="number"==typeof s?s:s.x,x="number"==typeof s?s:s.y,v={xmin:r.x-h,xmax:r.x+h,ymin:r.y-x,ymax:r.y+x,spatialReference:r.spatialReference},z=m?(0,he.iV)(v,e.spatialReference):v;if(!z)return{candidates:[]};const P=(yield(0,b.aX)((0,M.im)(r),null,{signal:i}))[0],C=(yield(0,b.aX)((0,M.im)(z),null,{signal:i}))[0];if((0,J.Wi)(P)||(0,J.Wi)(C))return{candidates:[]};let T=new G(e._searchFeatures(e._getQueryBBoxes(C.toJSON())),null,e);T=yield e._reschedule(()=>T.executeObjectIdsQuery(f),i),T=yield e._reschedule(()=>T.executeTimeQuery(f),i),T=yield e._reschedule(()=>T.executeAttributesQuery(f),i);const X=P.toJSON(),q=m?(0,he.iV)(X,e.spatialReference):X,ue=m?Math.max(z.xmax-z.xmin,z.ymax-z.ymin)/2:s;return T.createSnappingResponse(De(Oe({},t),{point:q,distance:ue}),r.spatialReference)})()}executeQueryForLatestObservations(t={},i){var e=this;return(0,F.Z)(function*(){if(!e.timeInfo||!e.timeInfo.trackIdField)throw new Y.Z(w,"Missing timeInfo or timeInfo.trackIdField",{query:t,timeInfo:e.timeInfo});let r,s=(0,ae.d9)(t);try{s=yield e._schedule(()=>(0,S.Up)(s,e.definitionExpression,e.spatialReference),i),s=yield e._reschedule(()=>e._checkQuerySupport(s),i),r=yield e._reschedule(()=>e._executeGeometryQuery(s,i),i),r=yield e._reschedule(()=>r.executeAggregateIdsQuery(s),i),r=yield e._reschedule(()=>r.executeObjectIdsQuery(s),i),r=yield e._reschedule(()=>r.executeTimeQuery(s),i),r=yield e._reschedule(()=>r.executeAttributesQuery(s),i),r=yield e._reschedule(()=>r.filterLatest(),i)}catch(l){if(l!==S.vF)throw l;r=new G([],null,e)}return r.createQueryResponse(s)})()}executeQueryForSummaryStatistics(t={},i,e){var r=this;return(0,F.Z)(function*(){const{field:s,normalizationField:l,valueExpression:f}=i;return(yield r._getQueryEngineResultForStats(t,{field:s,normalizationField:l,valueExpression:f},e)).createSummaryStatisticsResponse(t,i)})()}executeQueryForUniqueValues(t={},i,e){var r=this;return(0,F.Z)(function*(){const{field:s,valueExpression:l}=i;return(yield r._getQueryEngineResultForStats(t,{field:s,valueExpression:l},e)).createUniqueValuesResponse(t,i)})()}executeQueryForClassBreaks(t={},i,e){var r=this;return(0,F.Z)(function*(){const{field:s,normalizationField:l,valueExpression:f}=i;return(yield r._getQueryEngineResultForStats(t,{field:s,normalizationField:l,valueExpression:f},e)).createClassBreaksResponse(t,i)})()}executeQueryForHistogram(t={},i,e){var r=this;return(0,F.Z)(function*(){const{field:s,normalizationField:l,valueExpression:f}=i;return(yield r._getQueryEngineResultForStats(t,{field:s,normalizationField:l,valueExpression:f},e)).createHistogramResponse(t,i)})()}_schedule(t,i){var e=this;return(0,F.Z)(function*(){return(0,J.pC)(e._frameTask)?e._frameTask.schedule(t,i):t(D.G5)})()}_reschedule(t,i){var e=this;return(0,F.Z)(function*(){return(0,J.pC)(e._frameTask)?e._frameTask.reschedule(t,i):t(D.G5)})()}_getAll(){if(!this._allItems){const t=[];this.featureStore.forEach(i=>t.push(i)),this._allItems=new G(t,null,this)}return this._allItems}_executeGeometryQuery(t,i){var e=this;return(0,F.Z)(function*(){const{geometry:r,outSR:s,spatialRel:l,returnGeometry:f,returnCentroid:m}=t,h=e.featureStore.featureSpatialReference,x=r&&h&&h!==r.spatialReference?(0,he.iV)(r,h):r,v=f||m,z=(0,j.JY)(s)&&!(0,j.fS)(e.spatialReference,s),P=e._geometryQueryCache?z&&v?JSON.stringify({originalFilterGeometry:r,spatialRelationship:l,outSpatialReference:s}):JSON.stringify({originalFilterGeometry:r,spatialRelationship:l}):null;if(P){const W=e._geometryQueryCache.get(P);if(!(0,J.o8)(W))return W}const C=function(){var W=(0,F.Z)(function*(te){if(z&&v){const L=yield te.project(s);return P&&e._geometryQueryCache.put(P,L,L.size||1),L}return P&&e._geometryQueryCache.put(P,te,te.size||1),te});return function(L){return W.apply(this,arguments)}}();if(!x)return C(e._getAll());const T=e.featureAdapter;if("esriSpatialRelDisjoint"===l){const W=e._searchFeatures(e._getQueryBBoxes(r));if(!W.length)return C(e._getAll());let te,L;const U=new Set;for(const Se of W)U.add(T.getObjectId(Se));return yield e._reschedule(()=>{let Se=0;te=new Array(U.size),e.featureStore.forEach(Te=>te[Se++]=Te),L=U},i),C(yield e._reschedule((0,F.Z)(function*(){const Se=yield(0,g.cW)(l,x,e.geometryType,e.hasZ,e.hasM);return new G(yield e._runSpatialFilter(te,Me=>!L.has(T.getObjectId(Me))||Se(T.getGeometry(Me)),i),r,e)}),i))}const X=e._searchFeatures(e._getQueryBBoxes(r));if(!X.length){const W=new G([],r,e);return P&&e._geometryQueryCache.put(P,W,W.size||1),W}if(e._canExecuteSoloPass(x,t))return C(new G(X,r,e));const q=yield(0,g.cW)(l,x,e.geometryType,e.hasZ,e.hasM),ue=yield e._runSpatialFilter(X,W=>q(T.getGeometry(W)),i);return C(new G(ue,r,e))})()}_runSpatialFilter(t,i,e){var r=this;return(0,F.Z)(function*(){if(!i)return t;if((0,J.Wi)(r._frameTask))return t.filter(m=>i(m));let s=0;const l=new Array,f=function(){var m=(0,F.Z)(function*(h){for(;s<t.length;){const x=t[s++];i(x)&&(l.push(x),h.madeProgress()),h.done&&(yield r._reschedule(v=>f(v),e))}});return function(x){return m.apply(this,arguments)}}();return r._reschedule(m=>f(m),e).then(()=>l)})()}_canExecuteSoloPass(t,i){const{geometryType:e}=this,{spatialRel:r}=i;return(0,g.hN)(t)&&("esriSpatialRelEnvelopeIntersects"===r||"esriGeometryPoint"===e&&("esriSpatialRelIntersects"===r||"esriSpatialRelContains"===r||"esriSpatialRelWithin"===r))}_getQueryBBoxes(t){if((0,g.hN)(t)){if((0,M.YX)(t))return[(0,H.al)(t.xmin,t.ymin,t.xmax,t.ymax)];if((0,M.oU)(t))return t.rings.map(i=>(0,H.al)(Math.min(i[0][0],i[2][0]),Math.min(i[0][1],i[2][1]),Math.max(i[0][0],i[2][0]),Math.max(i[0][1],i[2][1])))}return[(0,A.$P)((0,H.Ue)(),t)]}_searchFeatures(t){for(const r of t)this.featureStore.forEachInBounds(r,s=>{le.add(s)});const i=new Array(le.size);let e=0;return le.forEach(r=>i[e++]=r),le.clear(),i}_checkStatisticsSupport(t,i){var e=this;return(0,F.Z)(function*(){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)throw new Y.Z(w,"Unsupported query options",{query:t});return Promise.all([e._checkAttributesQuerySupport(t),e._checkStatisticsParamsSupport(i),(0,g.P0)(t,e.geometryType,e.spatialReference),(0,he._W)(e.spatialReference,t.outSR)]).then(()=>t)})()}_checkStatisticsParamsSupport(t){var i=this;return(0,F.Z)(function*(){let e=[];if(t.valueExpression){const{arcadeUtils:r}=yield(0,V.LC)();e=r.extractFieldNames(t.valueExpression)}if(t.field&&e.push(t.field),t.normalizationField&&e.push(t.normalizationField),!e.length)throw new Y.Z(w,"params should have at least a field or valueExpression",{params:t});ye(i.fieldsIndex,e,"params contains missing fields")})()}_checkQuerySupport(t){var i=this;return(0,F.Z)(function*(){if(t.distance<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new Y.Z(w,"Unsupported query options",{query:t});return Promise.all([i._checkAttributesQuerySupport(t),i._checkStatisticsQuerySupport(t),(0,g.P0)(t,i.geometryType,i.spatialReference),(0,he._W)(i.spatialReference,t.outSR)]).then(()=>t)})()}_checkAttributesQuerySupport(t){const{outFields:i,orderByFields:e,returnDistinctValues:r,outStatistics:s}=t,l=s?s.map(f=>f.outStatisticFieldName&&f.outStatisticFieldName.toLowerCase()).filter(Boolean):[];if(e&&e.length>0){const f=" asc",m=" desc",h=e.map(x=>{const v=x.toLowerCase();return v.indexOf(f)>-1?v.split(f)[0]:v.indexOf(m)>-1?v.split(m)[0]:x}).filter(x=>-1===l.indexOf(x));ye(this.fieldsIndex,h,"orderByFields contains missing fields")}if(i&&i.length>0)ye(this.fieldsIndex,i,"outFields contains missing fields");else if(r)throw new Y.Z(w,"outFields should be specified for returnDistinctValues",{query:t});!function ze(N,t){if(!t)return!0;const i=ne.get(t,N);if(!i)throw new Y.Z(ee,"invalid SQL expression",{where:t});if(!i.isStandardized)throw new Y.Z(ee,"where clause is not standard",{where:t});ye(N,i.fieldNames,"where clause contains missing fields")}(this.fieldsIndex,t.where)}_checkStatisticsQuerySupport(t){var i=this;return(0,F.Z)(function*(){const{outStatistics:e,groupByFieldsForStatistics:r,having:s}=t,l=r&&r.length,f=e&&e.length;if(s){if(!l||!f)throw new Y.Z(w,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:t});!function Pe(N,t,i){if(!t)return!0;const e=ne.get(t,N);if(!e)throw new Y.Z(ee,"invalid SQL expression",{having:t});if(!e.isAggregate)throw new Y.Z(ee,"having does not contain a valid aggregate function",{having:t});if(ye(N,e.fieldNames,"having contains missing fields"),!e.getExpressions().every(s=>{const{aggregateType:l,field:f}=s,m=N.has(f)&&N.get(f).name;return i.some(h=>{const{onStatisticField:x,statisticType:v}=h;return(N.has(x)&&N.get(x).name)===m&&v.toLowerCase().trim()===l})}))throw new Y.Z(ee,"expressions in having should also exist in outStatistics",{having:t})}(i.fieldsIndex,s,e)}if(f){if(!function k(N){return N.every(t=>"exceedslimit"!==t.statisticType)}(e))return;const m=e.map(h=>h.onStatisticField).filter(Boolean);ye(i.fieldsIndex,m,"onStatisticFields contains missing fields"),l&&ye(i.fieldsIndex,r,"groupByFieldsForStatistics contains missing fields");for(const h of e){const{onStatisticField:x,statisticType:v}=h;if("percentile_disc"!==v&&"percentile_cont"!==v||!("statisticParameters"in h)){if("count"!==v&&x&&Fe(x,i.fieldsIndex))throw new Y.Z(w,"outStatistics contains non-numeric fields",{definition:h,query:t})}else{const{statisticParameters:z}=h;if(!z)throw new Y.Z(w,"statisticParamters should be set for percentile type",{definition:h,query:t})}}}})()}_getQueryEngineResultForStats(t={},i,e){var r=this;return(0,F.Z)(function*(){let s;t=(0,ae.d9)(t);try{t=yield r._schedule(()=>(0,S.Up)(t,r.definitionExpression,r.spatialReference),e),t=yield r._reschedule(()=>r._checkStatisticsSupport(t,i),e),s=yield r._reschedule(()=>r._executeGeometryQuery(t,e),e),s=yield r._reschedule(()=>s.executeAggregateIdsQuery(t),e),s=yield r._reschedule(()=>s.executeObjectIdsQuery(t),e),s=yield r._reschedule(()=>s.executeTimeQuery(t),e),s=yield r._reschedule(()=>s.executeAttributesQuery(t),e)}catch(l){if(l!==S.vF)throw l;s=new G([],null,r)}return s})()}}const Ye=(0,K.Ue)(),Re=(0,K.Ue)()},87757:(de,ie,p)=>{p.d(ie,{g:()=>F});const F={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},53023:(de,ie,p)=>{p.d(ie,{hN:()=>he,P0:()=>ve,cW:()=>xe});var F=p(15861),Y=p(26584),ae=p(33190),J=p(11519),O=p(91179),K=p(37053);function H(E,R){return E?R?4:3:R?3:2}function b(E,R,B,$,re){if(!E)return!1;const Z=H(R,B),{coords:y,lengths:_}=E;let S=!1,Q=0;for(const V of _)S=j(S,y,Z,Q,V,$,re),Q+=V*Z;return S}function j(E,R,B,$,re,Z,y){let _=E,S=$;for(let Q=$,V=$+re*B;Q<V;Q+=B){S=Q+B,S===V&&(S=$);const G=R[Q],o=R[Q+1],a=R[S],u=R[S+1];(o<y&&u>=y||u<y&&o>=y)&&G+(y-o)/(u-o)*(a-G)<Z&&(_=!_)}return _}var oe=p(82054),fe=p(88071),ce=p(82959),ne=p(6185);const ee="feature-store:unsupported-query",Ie={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},Ee_spatialRelationship={esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},Ee_queryGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},Ee_layerGeometry={esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1};function ze(E){return!0===Ee_spatialRelationship[E]}function Pe(E){return!0===Ee_queryGeometry[(0,O.Ji)(E)]}function me(E){return!0===Ee_layerGeometry[E]}function xe(E,R,B,$,re){if((0,O.oU)(R)&&"esriGeometryPoint"===B&&("esriSpatialRelIntersects"===E||"esriSpatialRelContains"===E)){const Z=(0,oe.Uy)(new fe.Z,R,!1,!1);return Promise.resolve(y=>function A(E,R,B,$){return b(E,R,B,$.coords[0],$.coords[1])}(Z,!1,!1,y))}if((0,O.oU)(R)&&"esriGeometryMultipoint"===B){const Z=(0,oe.Uy)(new fe.Z,R,!1,!1);if("esriSpatialRelContains"===E)return Promise.resolve(y=>function M(E,R,B,$,re,Z){const y=H(re,Z),{coords:_,lengths:S}=$;if(!S)return!1;for(let Q=0,V=0;Q<S.length;Q++,V+=y)if(!b(E,R,B,_[V],_[V+1]))return!1;return!0}(Z,!1,!1,y,$,re))}if((0,O.YX)(R)&&"esriGeometryPoint"===B&&("esriSpatialRelIntersects"===E||"esriSpatialRelContains"===E))return Promise.resolve(Z=>(0,ae.aV)(R,(0,ne.Op)(B,$,re,Z)));if((0,O.YX)(R)&&"esriGeometryMultipoint"===B&&"esriSpatialRelContains"===E)return Promise.resolve(Z=>(0,ae.lQ)(R,(0,ne.Op)(B,$,re,Z)));if((0,O.YX)(R)&&"esriSpatialRelIntersects"===E){const Z=function se(E){return"mesh"===E?J.h_:(0,J.IY)(E)}(B);return Promise.resolve(y=>Z(R,(0,ne.Op)(B,$,re,y)))}return function ye(){return Promise.all([p.e(4918),p.e(8592)]).then(p.bind(p,32825))}().then(Z=>{const y=Z[Ie[E]].bind(null,R.spatialReference,R);return _=>y((0,ne.Op)(B,$,re,_))})}function ve(E,R,B){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,F.Z)(function*(E,R,B){const{spatialRel:$,geometry:re}=E;if(re){if(!ze($))throw new Y.Z(ee,"Unsupported query spatial relationship",{query:E});if((0,K.JY)(re.spatialReference)&&(0,K.JY)(B)){if(!Pe(re))throw new Y.Z(ee,"Unsupported query geometry type",{query:E});if(!me(R))throw new Y.Z(ee,"Unsupported layer geometry type",{query:E});if(E.outSR)return(0,ce._W)(E.geometry&&E.geometry.spatialReference,E.outSR)}}})).apply(this,arguments)}function he(E){if((0,O.YX)(E))return!0;if((0,O.oU)(E)){for(const R of E.rings)if(5!==R.length||R[0][0]!==R[1][0]||R[0][0]!==R[4][0]||R[2][0]!==R[3][0]||R[0][1]!==R[3][1]||R[0][1]!==R[4][1]||R[1][1]!==R[2][1])return!1;return!0}return!1}},76530:(de,ie,p)=>{function F(O,K){if(!O)return null;const H=K.featureAdapter,{startTimeField:A,endTimeField:M}=O;let b=Number.POSITIVE_INFINITY,j=Number.NEGATIVE_INFINITY;if(A&&M)K.forEach(oe=>{const fe=H.getAttribute(oe,A),ce=H.getAttribute(oe,M);null==fe||isNaN(fe)||(b=Math.min(b,fe)),null==ce||isNaN(ce)||(j=Math.max(j,ce))});else{const oe=A||M;K.forEach(fe=>{const ce=H.getAttribute(fe,oe);null==ce||isNaN(ce)||(b=Math.min(b,ce),j=Math.max(j,ce))})}return{start:b,end:j}}function Y(O,K,H){if(!K||!O)return null;const{startTimeField:A,endTimeField:M}=O;if(!A&&!M)return null;const{start:b,end:j}=K;return null===b&&null===j?null:void 0===b&&void 0===j?()=>!1:A&&M?function ae(O,K,H,A,M){return null!=A&&null!=M?b=>{const j=O.getAttribute(b,K),oe=O.getAttribute(b,H);return(null==j||j<=M)&&(null==oe||oe>=A)}:null!=A?b=>{const j=O.getAttribute(b,H);return null==j||j>=A}:null!=M?b=>{const j=O.getAttribute(b,K);return null==j||j<=M}:void 0}(H,A,M,b,j):function J(O,K,H,A){return null!=H&&null!=A&&H===A?M=>O.getAttribute(M,K)===H:null!=H&&null!=A?M=>{const b=O.getAttribute(M,K);return b>=H&&b<=A}:null!=H?M=>O.getAttribute(M,K)>=H:null!=A?M=>O.getAttribute(M,K)<=A:void 0}(H,A||M,b,j)}p.d(ie,{R:()=>F,y:()=>Y})},6185:(de,ie,p)=>{p.d(ie,{EG:()=>Ie,Op:()=>ze,S2:()=>$,Up:()=>Pe,j6:()=>ve,vF:()=>oe});var F=p(15861),Y=p(2076),ae=p(62208),J=p(16730),se=p(15176),O=p(91179),K=p(13924),H=p(37053),A=p(82054),M=p(88071),b=p(82959);const j=new Y.X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),oe=Object.freeze({}),fe=new M.Z,ce=new M.Z,ne=new M.Z,ee={esriGeometryPoint:A.fQ,esriGeometryPolyline:A.J6,esriGeometryPolygon:A.eG,esriGeometryMultipoint:A.Iv};function Ie(y,_,S,Q=y.hasZ,V=y.hasM){if((0,ae.Wi)(_))return null;const G=y.hasZ&&Q,o=y.hasM&&V;if(S){const a=(0,A.Nh)(ne,_,y.hasZ,y.hasM,"esriGeometryPoint",S,Q,V);return(0,A.fQ)(a,G,o)}return(0,A.fQ)(_,G,o)}function ze(y,_,S,Q,V,G,o=_,a=S){const u=_&&o,g=S&&a,I=(0,ae.pC)(Q)?"coords"in Q?Q:Q.geometry:null;if((0,ae.Wi)(I))return null;if(V){let D=(0,A.zj)(ce,I,_,S,y,V,o,a);return G&&(D=(0,A.Nh)(ne,D,u,g,y,G)),ee[y](D,u,g)}if(G){const D=(0,A.Nh)(ne,I,_,S,y,G,o,a);return ee[y](D,u,g)}return(0,A.hY)(fe,I,_,S,o,a),ee[y](fe,u,g)}function Pe(y,_,S){return me.apply(this,arguments)}function me(){return(me=(0,F.Z)(function*(y,_,S){const{outFields:Q,orderByFields:V,groupByFieldsForStatistics:G,outStatistics:o}=y;if(Q)for(let a=0;a<Q.length;a++)Q[a]=Q[a].trim();if(V)for(let a=0;a<V.length;a++)V[a]=V[a].trim();if(G)for(let a=0;a<G.length;a++)G[a]=G[a].trim();if(o)for(let a=0;a<o.length;a++)o[a].onStatisticField&&(o[a].onStatisticField=o[a].onStatisticField.trim());return y.geometry&&!y.outSR&&(y.outSR=y.geometry.spatialReference),ve(y,_,S)})).apply(this,arguments)}function ve(y,_,S){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,F.Z)(function*(y,_,S){if(!y)return null;let{where:Q}=y;if(y.where=Q=Q&&Q.trim(),(!Q||/^1 *= *1$/.test(Q)||_&&_===Q)&&(y.where=null),!y.geometry)return y;let V=yield he(y);if(y.distance=0,y.units=null,"esriSpatialRelEnvelopeIntersects"===y.spatialRel){const{spatialReference:u}=y.geometry;V=(0,se.aO)(V),V.spatialReference=u}y.geometry=V,yield(0,b._W)(V.spatialReference,S);const G=(yield(0,K.aX)((0,O.im)(V)))[0];if((0,ae.Wi)(G))throw oe;const o=G.toJSON(),a=yield(0,b.iV)(o,o.spatialReference,S);if(!a)throw oe;return a.spatialReference=S,y.geometry=a,y})).apply(this,arguments)}function he(y){return E.apply(this,arguments)}function E(){return(E=(0,F.Z)(function*(y){const{geometry:_,distance:S,units:Q}=y;if(null==S||"vertexAttributes"in _)return _;const V=_.spatialReference,G=Q?j.fromJSON(Q):(0,J.qE)(V),o=V&&((0,H.sT)(V)||(0,H.sS)(V))?_:yield(0,b._W)(V,H.Zn).then(()=>(0,b.iV)(_,H.Zn));return(yield R())(o.spatialReference,o,S,G)})).apply(this,arguments)}function R(){return B.apply(this,arguments)}function B(){return(B=(0,F.Z)(function*(){return(yield Promise.all([p.e(4918),p.e(8592)]).then(p.bind(p,32825))).geodesicBuffer})).apply(this,arguments)}function $(y){return y&&re in y?JSON.parse(JSON.stringify(y,Z)):y}const re="_geVersion",Z=(y,_)=>y!==re?_:void 0}}]);